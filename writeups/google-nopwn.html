<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <title>Mercenary Labs - Using google to pwn websites</title>
    <link rel="icon" type="image/jpg" href="/images/favicon.ico">
    <link rel="stylesheet" href="https://mercenarylabs.net/css/tokyo-night-dark.min.css">
    <link rel='stylesheet' id='ghostkit-css' href='https://mercenarylabs.net/css/1-style.min.css' media='all' />
    <link rel='stylesheet' id='ghostkit-block-grid-css' href='https://mercenarylabs.net/css/2-style.min.css' media='all' />
    <link rel='stylesheet' id='cyberpulse-css' href='https://mercenarylabs.net/css/main.css' media='all' />
    <link rel='stylesheet' href='https://mercenarylabs.net/css/style.css' media='all' />
    <link rel='stylesheet' id='ghostkit-fonts-adobe-css' href='https://use.typekit.net/tfy7mmd.css?ver=1.7.3'
        media='all' />
    <script src='https://mercenarylabs.net/js/jquery.min.js' id='jquery-core-js'></script>
    <script src='https://mercenarylabs.net/js/jquery-migrate.min.js' id='jquery-migrate-js'></script>
    <script src='https://mercenarylabs.net/js/imagesloaded.min.js' id='imagesloaded-js'></script>
    <script id='cyberpulse-preloader-js-extra'> var cplPreloaderData = { "show_once": "" }; </script>
    <script src='https://mercenarylabs.net/js/preloader.js' id='cyberpulse-preloader-js'></script>
    <script
        id='ghost-framework-night-mode-js-extra'> var ghostFrameworkNightMode = { "default": "night", "is_editor": "", "use_local_storage": "", "night_class": "cpl-night-mode", "switching_class": "cpl-night-mode-switching", "toggle_selector": ".cpl-night-mode-toggle" }; </script>
    <script src='https://mercenarylabs.net/js/night-mode.min.js' id='ghost-framework-night-mode-js'></script>
</head>

<body class="home page-template-default page page-id-6 wp-embed-responsive content-size-container content-without-top-margin content-without-bottom-margin">

    <div class="cpl-preloader">
        <div class="cpl-preloader-logo">
            <!-- <img src="images/nopwn-logo.png" class="cpl-logo-night" data-skip-lazy="" alt="" /> -->
        </div>
    </div>

    <div class="cpl-page-noise"></div>

    <div id="page" class="site">

        <header id="masthead" class="site-header">
            <div class="cpl-navbar-container cpl-navbar-collapse-md cpl-navbar-align-right">
                <a href="/" class="cpl-navbar-logo">
                    <h1>ML</h1>
                </a>
            </div>
        </header>

        <div id="content" class="site-content" tabindex="-1">
            <div id="primary" class="content-area">
                <main id="main" class="site-main">
                    <article id="post-6" class="post-6 page type-page status-publish hentry">
                        <div class="entry-content">
                            <div style="padding-bottom:1px!important;padding-top:1px!important" class="ghostkit-grid ghostkit-grid-gap-md ghostkit-grid-with-bg ghostkit-custom-1709OK">
                                <div class="nk-awb alignfull">
                                    <div class="nk-awb-wrap" data-awb-type="image" data-awb-parallax="scroll" data-awb-parallax-speed="0.8" data-awb-parallax-mobile="true" data-awb-image-background-size="cover" data-awb-image-background-position="50% 10%">
                                        <div class="nk-awb-overlay" style="background-color: rgba(23, 23, 23, 0.8);"></div>
                                        <div class="nk-awb-inner"> <img class="vp-lazyload" data-src="https://mercenarylabs.net/images/soldiers.jpg" data-sizes="auto" loading="eager" height="1em"> </div>
                                    </div>
                                </div>

                                <div class="ghostkit-grid-inner">
                                    <div class="ghostkit-col ghostkit-col-12">
                                        <div class="ghostkit-col-content">
                                            <p class="has-text-align-center has-text-color" style="color:#f4f4f4;font-size:50px" data-ghostkit-sr="fade-up;distance:10px;duration:500;delay:100">
                                                <span class="ghostkit-text-uppercase">
                                                    <strong>Using google to pwn websites</strong>
                                                </span>
                                            </p>

                                            <div class="wp-block-image ghostkit-custom-Z1gmenb">
                                                <a> <img loading="lazy" class="aligncenter vp-lazyload" width="250px" data-src="https://mercenarylabs.net/images/patch_bl.png" data-sizes="auto"> </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div style="padding-top:80px!important;padding-bottom:0px!important;" class="ghostkit-grid ghostkit-grid-gap-md ghostkit-grid-with-bg ghostkit-custom-22dvsW">
                                <div class="nk-awb alignfull">
                                    <div class="nk-awb-wrap" data-awb-type="color">
                                        <div class="nk-awb-overlay" style="background-color: #101010;"></div>
                                    </div>
                                </div>

                                <div class="ghostkit-grid-inner" style="justify-content: center;">
                                    <div class="ghostkit-col ghostkit-col-8">
                                        <div class="ghostkit-col-content">

                                            <!-- Start of Content-->

                                            <h1 class="has-text-align-center" data-ghostkit-sr="fade-up;distance:1px;duration:500;delay:200">
                                                Using google to pwn websites
                                            </h1>
                                            <h3 class="has-text-align-center"
                                                data-ghostkit-sr="fade-up;distance:1px;duration:500;delay:200">
                                                By: <a href=/nopwn>Nopwn</a>
                                            </h3>

                                            <h2>What is google Dorking?</h2>
                                            Google Dorking is a method used by attackers that utilizes Google's special search terms and queries. For example: if you search "Barak Obama," you will be bombarded with articles about him during his presidency. However, let's say you are researching Obama as a senator rather than as a president. In that case, you can use the query "Barack Obama before:2006" to find information about him as a senator.
                                            <br><br>

                                            <h2>How do hackers use it?</h2>

                                            Google Dorking turns malicious when attackers exploit it to gather sensitive information. In this write-up, I will demonstrate various ways attackers utilize Google Dorking to discover private documents, access open directories, uncover passwords, and obtain other confidential data.

                                            <br><br>

                                            <h3>Open Directories</h3>

                                            A simple but effective query for google Dorking is: <pre><code>inurl:index of x</code></pre>
                                            here are some example searches you can try for yourself:

                                            <img src="images/nopwn-index1.png"/><br>
                                            <img src="images/nopwn-index2.png"/><br>
                                            
                                            When you gain access to an open directory, it provides you with a lot of information. As an attacker, this information can be used to create exploits, gather user data, and so on.

                                            <img src="images/nopwn-index3.png"/><br>

                                            The way to fix open directories is actually quite simple, and it's rather baffling that not every website does it. I will demonstrate the fix using Apache2, but the other fixes are equally straightforward. Just navigate to your Apache2 .htaccess file and add the following code:
                                            
                                            <pre><code>Options -Indexes</code></pre>

                                            this will turn all open directories into a 403 error.

                                            <br><br>

                                            <h3>Filetypes</h3>
                                            
                                            
                                            Searching by filetype is a powerful Google Dork. The term "filetype" refers to the extension at the end of a file, like .pdf, .doc, .xls, and so on. This technique has multiple applications, such as easily finding books. However, it is important to emphasize that accessing copyrighted material without proper authorization is both illegal and unethical.
                                            <pre><code>Book Name filetype:pdf</code></pre>
                                            Instead of going through dozens of scam sites before finding the actual pdf, you can instead just search with the filetype. Here is an example:
                                            <img src="images/nopwn-filetype.png"><br>
                                            As you can see, the very first result was the book we were looking for because we specified the filetype. <br>
                                            Apart from pirates, attackers can also exploit this technique to gather sensitive information, including source code, spreadsheets, user data, and more.

                                            <h4>Varegg's bad backup storing practices</h4>
                                            Here I am going to demonstrate finding source code using a Google search. 
                                            We are simply going to use this search term:
                                            <pre><code>"admin" filetype:bak</code></pre>

                                            After scrolling for only a few miliseconds we find an interesting website, 

                                            <img src="images/nopwn-Varegg1.png"><br>

                                            
                                            And when we visit the directory, it prompts us to download a file named password.php.0001.16f5.bak. This piques my interest because a PHP file on a website is typically not readable by users. It is considered secure backend code. However, when it's saved with extensions such as .bak or .save or anything after .php, it becomes readable to users. This poses a significant risk as PHP files often contain sensitive information such as credentials, SQL details, and more. <br>

                                            <br>
                                            
                                            Upon examining the code, we unfortunately do not retrieve SQL credentials as they are accessed through an included PHP file that remains hidden from us. However, what we can observe are the SQL statements used to execute queries for this site. This raises a few concerns. Firstly, it allows us to view the database structure, which is advantageous for hackers targeting SQL injection vulnerabilities. Secondly, it highlights poor coding practices, as the code directly inserts POST parameters into the query instead of using prepared statements, thereby leaving room for SQL injection attacks.

                                            <pre><code class="language-php">
<!-- $get_password = mysql_query("SELECT * FROM tplls_passwords WHERE PasswordID = '2'",$connection)
or die(mysql_error());
                                        
$password = mysql_fetch_array($get_password);
                                        
$new = $_POST['new'];
$new2 = $_POST['new2'];
$old = $_POST['old'];
                                        
if($old == '' || $new == '' || $new2 == '')
{
    $check = 'You must fill all fields.';
}
else
{	$old = md5($old);
    if($password['PasswordPassword'] != "$old")
    {
        $check = 'Your old password was wrong.';
    }  
    else
    {
        if($new != "$new2")
        {
            $check = 'You didn\'t retype correctly.';
        }
        else
        {
            $new = md5($new);
            mysql_query("UPDATE tplls_passwords SET PasswordPassword = '$new' WHERE PasswordID = '2'",$connection)
            or die(mysql_error());
            $check = 'Password changed succesfully!';
        }
    }
} -->
                                        
                                        </code></pre>

                                        This very ugly piece of PHP code is not only ugly but also vulnerable as we can see with this statement:
                                        <pre><code class="language-php">mysql_query("UPDATE tplls_passwords SET PasswordPassword = '$new' WHERE PasswordID = '2'",$connection)</code></pre>
                                        We can see that the SQL query is directly using the "$_POST['new']" variable in the query which means there is no sanitization. So theoretically
                                        if we were to try using &new='f'; DROP TABLE tplls_passwords; -- in our post request it would be:
                                        <pre><code class="language-php">mysql_query("UPDATE tplls_passwords SET PasswordPassword = 'f'; DROP TABLE tplls_passwords; -- WHERE PasswordID = '2'", $connection);                                        </code></pre>
                                        This will set the password to 'f' in order to prevent validation errors, and then drop or delete the entire table if an attacker wanted to be disruptive.

                                        As a result we are able to go from a simple google search, to destroying the availability and integrity of the sites data "theoretically". 
                                        <br><br>
                                        <h3>Credential Harvesting</h3>

                                        We can also use the "filetype" google Dork to harvest credentials. We will simply go over some examples rather than going overly in-depth.

                                        <pre><code>intitle:untitled filetype:xls intext:password</code></pre>

                                        <img src="images/nopwn-passwordharvesting.png"><br>

                                        <pre><code>filetype:env "DB_PASSWORD"</code></pre>

                                        <img src="images/nopwn-moreharvesting.png"><br>
                                        <img src="images/nopwn-morecredharvesting.png"><br>
                                        <img src="images/nopwn-evenmore.png"><br>

                                            <br>

                                            <h2>Conclusion</h2>
                                            This was only a short introduction to google Dorking, and can be used for much more than what we have done here. 
                                            There are several important notes we can take from this: the first is that this can be a great tool for Bug Bounty Hunting. However, it is important to ensure you stay within scope;
                                            finding certain information can be illegal. The second is that you should not store anything sensitive on a web server unless you intend to share it.
                                            . The third thing to note is to close your damn directories, so many major companies fail to do this, and it consistently leads to being pwned.
                                            <br>

                                            <!-- End of Content-->

                                        </div>
                                    </div>
                                </div>
                                <div class="ghostkit-grid-inner">
                                    <div class="ghostkit-col ghostkit-col-12">
                                        <div class="ghostkit-col-content">
                                            <h2 class="has-text-align-center" id="6-ready-to-use-demos" data-ghostkit-sr="fade-up;distance:10px;duration:500;delay:200">
                                                <br>
                                                <hr style="margin-bottom: 16px;">
                                                SECURITY - INTELLIGENCE - DEVELOPMENT
                                            </h2>
                                           <p class="has-text-align-center ghostkit-custom-1OHkH5 has-text-color" style="color:#b1b1b1" data-ghostkit-sr="fade-up;distance:10px;duration:500;delay:300">
                                                Penetration Testing | Reverse Engineering | Exploit Development | Malware Development<br><br> <a href="javascript:document.discordInvite();">Join Us</a>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>
                </main>
            </div>
        </div>
    </div>
    <script src="https://mercenarylabs.net/js/wpdf.min.js" defer></script>
    <script id='ghostkit-helper-js-extra'>
        document.documentElement.classList.add('ghostkit-sr-enabled');
        document.documentElement.classList.add('vp-lazyload-enabled');
        var ghostkitVariables = { "themeName": "CyberPulse", "settings": [], "disabledBlocks": [], "media_sizes": { "sm": 567, "md": 777, "lg": 1077, "xl": 1387 }, "timezone": "UTC+00:00", "googleMapsAPIKey": "", "googleMapsAPIUrl": "https:\/\/maps.googleapis.com\/maps\/api\/js?v=3.exp&language=en", "googleMapsLibrary": { "url": "https:\/\/wp.nkdev.info\/cyberpulse\/promo\/wp-content\/plugins\/ghostkit\/assets\/vendor\/gmaps\/gmaps.min.js?ver=0.4.25" }, "googleReCaptchaAPISiteKey": "", "googleReCaptchaAPISecretKey": "", "sidebars": { "sidebar-post": { "id": "sidebar-post", "name": "Posts Sidebar" }, "sidebar-page": { "id": "sidebar-page", "name": "Pages Sidebar" }, "sidebar-woocommerce": { "id": "sidebar-woocommerce", "name": "WooCommerce Sidebar" }, "sidebar-cyberpress": { "id": "sidebar-cyberpress", "name": "CyberPress Sidebar" }, "offcanvas": { "id": "offcanvas", "name": "Offcanvas" }, "mobile-navbar": { "id": "mobile-navbar", "name": "Mobile Navbar" }, "sidebar-above-footer": { "id": "sidebar-above-footer", "name": "Footer Widgets" }, "sidebar-above-footer-1": { "id": "sidebar-above-footer-1", "name": "Footer Widgets Column 1" }, "sidebar-above-footer-2": { "id": "sidebar-above-footer-2", "name": "Footer Widgets Column 2" }, "sidebar-above-footer-3": { "id": "sidebar-above-footer-3", "name": "Footer Widgets Column 3" }, "sidebar-above-footer-4": { "id": "sidebar-above-footer-4", "name": "Footer Widgets Column 4" } }, "icons": [], "shapes": [], "fonts": [], "customTypographyList": [], "variants": { "accordion": { "default": { "title": "Default" } }, "accordion_item": { "default": { "title": "Default" } }, "alert": { "default": { "title": "Default" } }, "button_wrapper": { "default": { "title": "Default" } }, "button": { "default": { "title": "Default" } }, "carousel": { "default": { "title": "Default" } }, "carousel_slide": { "default": { "title": "Default" } }, "changelog": { "default": { "title": "Default" } }, "counter_box": { "default": { "title": "Default" } }, "divider": { "default": { "title": "Default" } }, "gist": { "default": { "title": "Default" } }, "google_maps": { "default": { "title": "Default" } }, "grid": { "default": { "title": "Default" } }, "grid_column": { "default": { "title": "Default" } }, "icon_box": { "default": { "title": "Default" } }, "instagram": { "default": { "title": "Default" } }, "pricing_table": { "default": { "title": "Default" } }, "pricing_table_item": { "default": { "title": "Default" } }, "progress": { "default": { "title": "Default" } }, "tabs": { "default": { "title": "Default" } }, "tabs_tab": { "default": { "title": "Default" } }, "testimonial": { "default": { "title": "Default" } }, "twitter": { "default": { "title": "Default" } }, "video": { "default": { "title": "Default" } } }, "admin_url": "https:\/\/wp.nkdev.info\/cyberpulse\/promo\/wp-admin\/", "admin_templates_url": "https:\/\/wp.nkdev.info\/cyberpulse\/promo\/wp-admin\/edit.php?post_type=ghostkit_template" };
    </script>
    <script src='https://mercenarylabs.net/js/helper.min.js' id='ghostkit-helper-js'></script>
    <script src='https://mercenarylabs.net/js/scrollreveal.min.js' id='scrollreveal-js'></script>
    <script src='https://mercenarylabs.net/js/main.min.js' id='ghostkit-js'></script>
    <script src='https://mercenarylabs.net/js/lazysizes-cfg.min.js' id='lazysizes-config-js'></script>
    <script src='https://mercenarylabs.net/js/lazysizes.min.js' id='lazysizes-js'></script>
    <script src="https://mercenarylabs.net/js/highlight.min.js"></script>
    <script> hljs.highlightAll();</script>
</body>

</html>